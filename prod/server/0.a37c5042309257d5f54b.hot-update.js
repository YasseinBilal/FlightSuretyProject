exports.id=0,exports.modules={"./src/server/server.js":function(e,t,n){"use strict";n.r(t);var c=n("./build/contracts/FlightSuretyApp.json"),o=n("./build/contracts/FlightSuretyData.json"),a=n("./src/server/config.json"),s=n("web3"),r=n.n(s),u=n("express"),i=n.n(u),l=n("cors"),f=n.n(l);function d(e){throw new TypeError('"'+e+'" is read-only')}var h=a.localhost,g=new r.a(new r.a.providers.WebsocketProvider(h.url.replace("http","ws")));g.eth.defaultAccount=g.eth.accounts[0];var m=new g.eth.Contract(c.abi,h.appAddress),p=new g.eth.Contract(o.abi,h.dataAddress),v=[],A=[],E=i()();E.use(f()()),E.listen(80,(function(){})),E.get("/api",(function(e,t){t.send({message:"An API for use with your Dapp!"})})),E.get("/api/status/:status",(function(e,t){var n="Status changed to: ";switch(e.params.status){case"10":d("defaultStatus"),n=n.concat("ON TIME");break;case"20":d("defaultStatus"),n=n.concat("LATE AIRLINE");break;case"30":d("defaultStatus"),n=n.concat("LATE WEATHER");break;case"40":d("defaultStatus"),n=n.concat("LATE TECHNICAL");break;case"50":d("defaultStatus"),n=n.concat("LATE OTHER");break;default:d("defaultStatus"),n=n.concat("UNKNOWN")}t.send({message:n})})),m.events.OracleRequest({fromBlock:"latest"},(function(e,t){e&&console.log(e),console.log(t);var n=t.returnValues.index;console.log("Triggered index: ".concat(n));A.forEach((function(e){var c=v[0];e[0]!=n&&e[1]!=n&&e[2]!=n||(console.log("Oracle: ".concat(c," triggered. Indexes: ").concat(e,".")),function(e,t,n,c,o){var a={index:t,airline:n,flight:c,timestamp:o,statusCode:10};m.methods.submitOracleResponse(t,n,c,o,10).send({from:e,gas:5e5,gasPrice:2e7},(function(e,t){e&&console.log(e,a)})),!1}(c,n,t.returnValues.airline,t.returnValues.flight,t.returnValues.timestamp)),d("idx")}))})),p.events.allEvents({fromBlock:"latest"},(function(e,t){e?console.log("error",e):console.log("event:",t)})),new Promise((function(e,t){g.eth.getAccounts().then((function(e){e.slice(20,45),d("oracleAccounts")})).catch((function(e){t(e)})).then((function(){e(v)}))})).then((function(e){(function(e){return new Promise((function(t,n){m.methods.REGISTRATION_FEE().call().then((function(c){for(var o=function(t){m.methods.registerOracle().send({from:e[t],value:c,gas:5e6,gasPrice:2e7}).then((function(){m.methods.getMyIndexes().call({from:e[t]}).then((function(n){console.log("Oracle ".concat(t," Registered at ").concat(e[t]," with [").concat(n,"] indexes.")),A.push(n)})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))};;d("a"))o(0);t(A)})).catch((function(e){n(e)}))}))})(e).catch((function(e){console.log(e.message)}))})),t.default=E}};