exports.id=0,exports.modules={"./src/server/server.js":function(e,t,n){"use strict";n.r(t);var o=n("./src/server/config.json"),s=n("web3"),c=n.n(s),a=n("express"),r=n.n(a),i=n("cors"),l=n.n(i),u=n("./build/contracts/FlightSuretyApp.json"),f=n("./build/contracts/FlightSuretyData.json"),d=o.localhost,h=new c.a(new c.a.providers.WebsocketProvider(d.url.replace("http","ws"))),g=r()();g.use(l()()),h.eth.defaultAccount=h.eth.accounts[0];var m=new h.eth.Contract(u.abi,d.appAddress),p=new h.eth.Contract(f.abi,d.dataAddress),v=[],A=[],E=10;m.events.OracleRequest({fromBlock:"latest"},(function(e,t){var n=t.returnValues.index;console.log("index !!",n),console.log("oraclesIndexies",A);var o=0;A.forEach((function(e){console.log("indexes !!",e);var s=v[o];e[0]!=n&&e[1]!=n&&e[2]!=n||function(e,t,n,o,s){var c={index:t,airline:n,flight:o,timestamp:s,statusCode:defaultStatus};m.methods.submitOracleResponse(t,n,o,s,defaultStatus).send({from:e,gas:5e5,gasPrice:2e7},(function(e,t){e&&console.log(e,c)})),20==defaultStatus&&p.methods.creditInsurees(o).call({from:e},(function(e,t){e?console.log(e,c):console.log("Credit set for insurees")}))}(s,n,t.returnValues.airline,t.returnValues.flight,t.returnValues.timestamp),o++}))})),p.events.allEvents({fromBlock:"latest"},(function(e,t){e?console.log("error",e):console.log("event",t)})),new Promise((function(e,t){h.eth.getAccounts().then((function(e){v=e.slice(20,45)})).catch((function(e){console.log("in !!!!!"),t(e)})).then((function(){e(v)}))})).then((function(e){var t;console.log("init !!!!!"),(t=e,new Promise((function(e,n){m.methods.REGISTRATION_FEE().call().then((function(o){for(var s=function(e){m.methods.registerOracle().send({from:t[e],value:o,gas:4e6,gasPrice:3e7}).then((function(){m.methods.getMyIndexes().call({from:t[e]}).then((function(e){console.log("in orache",e),A.push(e)})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))},c=0;c<25;c++)s(c);e(A)})).catch((function(e){n(e)}))}))).catch((function(e){console.log(e.message)}))})),g.get("/api",(function(e,t){t.send({message:"An API for use with your Dapp!"})})),g.get("/api/status/:status",(function(e,t){var n="Status changed, ";switch(e.params.status){case"10":E,n=n.concat("ON TIME");break;case"20":20,n=n.concat("LATE AIRLINE");break;case"30":30,n=n.concat("LATE WEATHER");break;case"40":40,n=n.concat("LATE TECHNICAL");break;case"50":50,n=n.concat("LATE OTHER");break;default:0,n=n.concat("UNKNOWN")}t.send({message:n})})),g.listen(80,(function(){console.log("app listening on port",80)})),t.default=g}};