exports.id=0,exports.modules={"./src/server/config.json":function(e){e.exports=JSON.parse('{"localhost":{"url":"http://localhost:8545","dataAddress":"0x162deDA1A27CFBbA210De02e017FBBfd14f45DFc","appAddress":"0xD09B31B0D35DC0EaB2Cb6DF79372A38A30818B30"}}')},"./src/server/server-config.json":!1,"./src/server/server.js":function(e,t,n){"use strict";n.r(t);var s=n("./src/server/config.json"),c=n("web3"),o=n.n(c),r=n("express"),a=n.n(r),u=n("cors"),i=n.n(u),l=n("./build/contracts/FlightSuretyApp.json"),f=n("./build/contracts/FlightSuretyData.json"),d=s.localhost,h=new o.a(new o.a.providers.WebsocketProvider(d.url.replace("http","ws"))),p=a()();p.use(i()()),h.eth.defaultAccount=h.eth.accounts[0];var g=new h.eth.Contract(l.abi,d.appAddress),A=new h.eth.Contract(f.abi,d.dataAddress),m=[],v=[],E=b,b=10;g.events.OracleRequest({fromBlock:"latest"},(function(e,t){var n=t.returnValues.index,s=0;v.forEach((function(e){var c=m[s];e[0]!=n&&e[1]!=n&&e[2]!=n||function(e,t,n,s,c){g.methods.submitOracleResponse(t,n,s,c,E).send({from:e,gas:4e5,gasPrice:3e7}),20==E&&A.methods.creditInsurees(s).call({from:e})}(c,n,t.returnValues.airline,t.returnValues.flight,t.returnValues.timestamp),s++}))})),A.events.allEvents({fromBlock:"latest"},(function(e,t){e?console.log("error",e):console.log("event",t)})),new Promise((function(e,t){h.eth.getAccounts().then((function(e){return m=e.slice(20,45)})).catch((function(e){t(e)}))})).then((function(e){var t;(t=e,new Promise((function(e,n){g.methods.REGISTRATION_FEE().call().then((function(s){for(var c=function(e){g.methods.registerOracle().send({from:t[e],value:s,gas:4e6,gasPrice:3e7}).then((function(){g.methods.getMyIndexes().call({from:t[e]}).then((function(e){v.push(e)})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))},o=0;o<25;o++)c(o);e(v)})).catch((function(e){n(e)}))}))).catch((function(e){console.log(e.message)}))})),p.get("/api",(function(e,t){t.send({message:"An API for use with your Dapp!"})})),p.get("/api/status/:status",(function(e,t){var n="Status changed, ";switch(e.params.status){case"10":E=b,n=n.concat("ON TIME");break;case"20":E=20,n=n.concat("LATE AIRLINE");break;case"30":E=30,n=n.concat("LATE WEATHER");break;case"40":E=40,n=n.concat("LATE TECHNICAL");break;case"50":E=50,n=n.concat("LATE OTHER");break;default:E=0,n=n.concat("UNKNOWN")}t.send({message:n})})),p.listen(80,(function(){console.log("app listening on port",80)})),t.default=p}};